---
output:
  word_document: default
##  html_document: default
---


```{r, include=TRUE, echo=FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/H4L3ST0RM/ISQS-6350-Group3-Project/master/Guyana/src/cover_page.jpg") # insert cover page

# redundant due to cover page?
#---
#title: "Guyana Data Analysis"
#author: "John C. Hale, Leonard Clinton"
#date: "November 23, 2019"
#output: pdf_document
#---
#---
#title: "Group 3 Project"
#authors: "John C. Hale, Leonard Clinton"
#date: "November 20, 2019"
#output: html_document
#---
# Introduction
#Clearly describe the dataset and clearly describe the motivation behind studying the data. 
#Provide scholarly citations or quantitative facts to describe the motivation
# Data Cleaning & Visualization
#Clearly describe the data cleaning and outlier removal process.
#Present insightful visualizations motivating to do further exploratory or confirmatory analysis.
```
&nbsp;

&nbsp;

&nbsp;

### Install the Required Packages
```{r}
#install.packages("MVA")
library(MVA)
library(dplyr)
```

### Read in Data
```{r}
options( warn = -1, width = 160 )
census <- read.csv("https://raw.githubusercontent.com/H4L3ST0RM/ISQS-6350-Group3-Project/master/Guyana/data/cleaned_census_perc_data2.csv")
#census_perc <- read.csv("../data/cleaned_census_perc_data2.csv")
focus <- c('ID','Region','Agriculture', 'Construction', 'IT', 'Finance', 'Education', 'Manufacturing', 'Population')
census$ID <- seq.int(nrow(census))
mydata <- census[,focus]
myindustries <- mydata[,3:9]
head(mydata)
options(digits = 3)

```

### Correlation Matrix
```{r}
cor <- cor(mydata)
cor
```


```{r}
bvbox(myindustries[,c('IT','Finance')],type = "n",
     xlab = "Finance",
     ylab = "IT",
     pch = 1)
text(myindustries[,c('Finance','IT')], cex = 1, label = myindustries$ID,pch=1)
```
outliers = 718, 587, 775, 654, 523, 582, 738, 219, 953
           460, 219, 738, 582, 1018, 967, 1028, 963, 951

### Variable Distributions
Most all of the percentage variables are normally distributed.
```{r}
plot(density(scale(myindustries$Education), bw = .5, kernel ="gaussian"))

```

# Dimensionality Reduction Analysis
Apply dimension reduction analysis correctly and discuss the motivation behind that. Also provide interesting insights into the results.

### Principal Component Analysis

```{r}
census_pca <- princomp(scale(myindustries), cor = T)

summary(census_pca, cor=T, loadings = T)
```
```{r, dpi=300, fig.width=15, fig.height=8}
biplot(census_pca$scores[,1:2], census_pca$loadings[,1:2],col=c("black", "red"), cex = 1)
```

### a) Create a scaled distance matrix for observation.
```{r}
census.mds = cmdscale(dist(scale(myindustries)), eig = T) 
cumsum(census.mds$eig)/sum(census.mds$eig)
```

### Performing Graphical MDS on Distance Matrix
```{r}
myindustries.mds = cmdscale(dist(scale(myindustries)), eig = T) 
 
eignv <- abs(myindustries.mds$eig) 
 
plot(myindustries.mds$points[,1:2], pch = ".")
text(myindustries.mds$points[,1:2], labels = mydata$Region, cex = 0.6) 
```

Notice that region 4 contains nearly all of the outliers.



### Convert Correlation Matrix to Distance

Below we are getting the distances between each variable. 

```{r}
#install.packages("psych")
library(psych)
mydata.cor = cmdscale(cor2dist(cor(mydata)),eig=T)
mydata.cor
```

### 
```{r}

eignv <- abs(mydata.cor$eig) 

plot(mydata.cor$points[,1:2], type = "p")
par(mar=c(1,1,1,1))
text(mydata.cor$points[,1:2], labels = colnames(mydata), cex = 0.6, pos = 1)

```

Above you can see how the various industires relate to one another.

# Cluster Analysis
Apply cluster analysis correctly and discuss the motivation behind that. Also, provide interesting insights into the results.

# Confirmatory Factor Analysis
Define appropriate latent variables and apply CFA correctly and discuss the motivation.
Provide insights into the results

# Conclusion
 Present meaningful findings and discuss the pros and cons of the study.
Suggest some future works for post analysis.








