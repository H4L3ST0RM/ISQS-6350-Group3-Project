---
title: "Group 3 Final Project"
author: "John C. Hale, Larry Clinton"
date: "November 21, 2019"
output: html_document
---

```{r}
#install.packages("MVA")
#install.packages("car")
library(MVA)
library(dplyr)
library(car)
```

### Read in Data
```{r}
options( warn = -1, width = 160 )
wine <- read.csv("../data/winequality-red.csv")
head(wine)
options(digits = 3)

```




### Correlation Matrix

```{r}
cor <- cor(wine)
cor
```

Residual_Sugar has relatively low correlation with all the other variables, as does sulphates. So lets drop those
```{r}
wine = subset(wine, select = -c(residual_sugar,sulphates) )
cor <- cor(wine)
```

```{r}
wine<-wine[(wine$quality==8 | wine$quality==3),]
unique(wine$quality)

```


```{r}
d = dist(wine)
wine.s = scale(wine, center = TRUE, scale = TRUE)
d.s = dist(wine.s)
#round((d.s), 2)
#wine.s
d.s[,1:10]
```


Example of Euclidean distance in R:
```{r}
# The Euclidean distance between the first two units (observations or rows) in data:
d = dist(wine)
#d
```

Euclidean distances depend on measurements cales so, we should standardize data before finding distances

```{r}
wine.s = scale(wine)

d.s = dist(wine.s[1:12,])

d.s
```

We can present pairwise scaled Euclidean distances between the first 10 units as follows:

```{r}
box <- boxplot(wine.s)
box
text(box$group,                                              # the x locations 
     box$out,                                                # the y values
     rownames(wine.s)[which(wine.s == box$out, arr.ind=TRUE)[, 1]],  # the labels
     pos = 4) 
```





```{r, dpi=300}
# draw bivariate boxplot (must load MVA package)
bvbox(wine[c('total_sulfur_dioxide','alcohol')], xlab = "Total Sulfur Dioxide", ylab = "Alcohol", type = "n")


# label those five cities
text(wine$total_sulfur_dioxide, wine$alcohol, labels = wine$quality, cex = 0.7, pos = 1)
```

```{r}
bvbox(wine[c('pH','alcohol')],
     xlab = "pH",
     ylab = "alcohol",
     type = "n",
     pch = 5)
text(wine$pH,wine$alcohol, cex = 0.8, label = wine$quality,pch=10)
```


```{r}
wine_pca <- princomp(wine, cor = T)

summary(wine_pca, cor=T, loadings = T)
```




```{r, dpi=300, fig.width=15, fig.height=8}
biplot(wine_pca$scores[,1:2], wine_pca$loadings[,1:2],col=c("black", "red"), cex = 0.6, lab=wine_pca$quality)

```

### a) Create a scaled distance matrix for observation.
```{r}
census.mds = cmdscale(dist(scale(census)), eig = T) 
cumsum(census.mds$eig)/sum(census.mds$eig)
```

### b) Perform Graphical MDS on Distance Matrix
```{r}
census.mds = cmdscale(dist(scale(census)), eig = T) 
 
eignv <- abs(census.mds$eig) 
 
plot(census.mds$points[,1:2], pch = ".")
text(census.mds$points[,1:2], labels = census$Region, cex = 0.6) 
```

### c) Convert Correlation Matrix to Distance
```{r}
#install.packages("psych")
library(psych)
census.cor = cmdscale(cor2dist(cor(census[,2:23])),eig=T)
census.cor
```


### d) Plot Correlation "Distance" Matrix
```{r}

eignv <- abs(census.cor$eig) 
 
plot(census.cor$points[,1:2], pch = ".")
text(census.cor$points[,1:2], labels = colnames(census[,2:23]), cex = 0.55)

```











